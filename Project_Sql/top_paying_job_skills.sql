
WITH top_paying_jobs AS (
    SELECT 
    job_id,
    job_title,
    salary_year_avg ,
    name AS company_name
FROM 
    job_postings_fact 
LEFT JOIN company_dim
     ON job_postings_fact.company_id = company_dim.company_id    

WHERE 
     job_title_short = 'Data Engineer' AND 
     job_location = 'Anywhere' AND 
     salary_year_avg IS NOT NULL
ORDER BY 
      salary_year_avg DESC    
LIMIT 100
)

SELECT 
      top_paying_jobs.*,
      skills
FROM top_paying_jobs
INNER JOIN skills_job_dim ON top_paying_jobs.job_id = skills_job_dim.job_id
INNER JOIN skills_dim ON skills_job_dim.skill_id = skills_dim.skill_id
ORDER BY 
     salary_year_avg DESC

/*
The dataset contains a "skills" column listing different skills required for Data Engineer roles.
 I'll now analyze the most frequently mentioned skills and generate a visual representation. ​​

Here's a bar chart visualizing the top 15 most in-demand skills for Data Engineer roles in 2024 

[
  "job_id","job_title","salary_year_avg","company_name","skills"
21321,"Data Engineer","325000.0","Engtal","python"
21321,"Data Engineer","325000.0","Engtal","spark"
21321,"Data Engineer","325000.0","Engtal","pandas"
21321,"Data Engineer","325000.0","Engtal","numpy"
21321,"Data Engineer","325000.0","Engtal","pyspark"
21321,"Data Engineer","325000.0","Engtal","hadoop"
21321,"Data Engineer","325000.0","Engtal","kafka"
21321,"Data Engineer","325000.0","Engtal","kubernetes"
157003,"Data Engineer","325000.0","Engtal","python"
157003,"Data Engineer","325000.0","Engtal","spark"
157003,"Data Engineer","325000.0","Engtal","pandas"
157003,"Data Engineer","325000.0","Engtal","numpy"
157003,"Data Engineer","325000.0","Engtal","pyspark"
157003,"Data Engineer","325000.0","Engtal","hadoop"
157003,"Data Engineer","325000.0","Engtal","kafka"
157003,"Data Engineer","325000.0","Engtal","kubernetes"
270455,"Data Engineer","300000.0","Durlston Partners","sql"
270455,"Data Engineer","300000.0","Durlston Partners","python"
230458,"Director of Engineering - Data Platform","251000.0","Twitch","spark"
230458,"Director of Engineering - Data Platform","251000.0","Twitch","hadoop"
230458,"Director of Engineering - Data Platform","251000.0","Twitch","kafka"
230458,"Director of Engineering - Data Platform","251000.0","Twitch","tensorflow"
230458,"Director of Engineering - Data Platform","251000.0","Twitch","keras"
230458,"Director of Engineering - Data Platform","251000.0","Twitch","pytorch"
561728,"Data Engineer","250000.0","AI Startup","python"
561728,"Data Engineer","250000.0","AI Startup","scala"
561728,"Data Engineer","250000.0","AI Startup","r"
561728,"Data Engineer","250000.0","AI Startup","azure"
543728,"Staff Data Engineer","250000.0","Signify Technology","python"
543728,"Staff Data Engineer","250000.0","Signify Technology","scala"
543728,"Staff Data Engineer","250000.0","Signify Technology","databricks"
543728,"Staff Data Engineer","250000.0","Signify Technology","spark"
595768,"Principal Data Engineer","250000.0","Signify Technology","python"
595768,"Principal Data Engineer","250000.0","Signify Technology","scala"
595768,"Principal Data Engineer","250000.0","Signify Technology","databricks"
595768,"Principal Data Engineer","250000.0","Signify Technology","spark"
204320,"Staff Data Engineer","245000.0","Handshake","go"
151972,"Principal Data Engineer (Remote)","245000.0","Movable Ink","nosql"
151972,"Principal Data Engineer (Remote)","245000.0","Movable Ink","aws"
151972,"Principal Data Engineer (Remote)","245000.0","Movable Ink","gcp"
2446,"Data Engineering Manager","242000.0","Meta","sql"
2446,"Data Engineering Manager","242000.0","Meta","python"
2446,"Data Engineering Manager","242000.0","Meta","java"
2446,"Data Engineering Manager","242000.0","Meta","perl"
609418,"Data Engineering Manager","242000.0","Meta","sql"
609418,"Data Engineering Manager","242000.0","Meta","python"
609418,"Data Engineering Manager","242000.0","Meta","java"
609418,"Data Engineering Manager","242000.0","Meta","perl"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","sql"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","python"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","scala"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","r"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","golang"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","aws"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","redshift"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","spark"
456144,"Data Engineering Manager - Event Streaming and Real-Time Analytics","235000.0","LTK","kafka"
14251,"Staff Data Engineer","234500.0","Hinge","sql"
14251,"Staff Data Engineer","234500.0","Hinge","python"
14251,"Staff Data Engineer","234500.0","Hinge","aws"
14251,"Staff Data Engineer","234500.0","Hinge","bigquery"
14251,"Staff Data Engineer","234500.0","Hinge","redshift"
14251,"Staff Data Engineer","234500.0","Hinge","gcp"
14251,"Staff Data Engineer","234500.0","Hinge","airflow"
14251,"Staff Data Engineer","234500.0","Hinge","kafka"
14251,"Staff Data Engineer","234500.0","Hinge","looker"
14251,"Staff Data Engineer","234500.0","Hinge","terraform"
14251,"Staff Data Engineer","234500.0","Hinge","kubernetes"
14251,"Staff Data Engineer","234500.0","Hinge","docker"
11602,"Data Engineer, Analytics (Generalist)","233000.0","Meta","sql"
11602,"Data Engineer, Analytics (Generalist)","233000.0","Meta","python"
173752,"Data Engineering Leader","227630.0","Henry Schein One","sql"
173752,"Data Engineering Leader","227630.0","Henry Schein One","python"
173752,"Data Engineering Leader","227630.0","Henry Schein One","nosql"
173752,"Data Engineering Leader","227630.0","Henry Schein One","java"
173752,"Data Engineering Leader","227630.0","Henry Schein One","go"
173752,"Data Engineering Leader","227630.0","Henry Schein One","cassandra"
173752,"Data Engineering Leader","227630.0","Henry Schein One","azure"
173752,"Data Engineering Leader","227630.0","Henry Schein One","aws"
173752,"Data Engineering Leader","227630.0","Henry Schein One","snowflake"
173752,"Data Engineering Leader","227630.0","Henry Schein One","spark"
173752,"Data Engineering Leader","227630.0","Henry Schein One","kafka"
173752,"Data Engineering Leader","227630.0","Henry Schein One","gdpr"
173752,"Data Engineering Leader","227630.0","Henry Schein One","splunk"
173752,"Data Engineering Leader","227630.0","Henry Schein One","terraform"
173752,"Data Engineering Leader","227630.0","Henry Schein One","kubernetes"
173752,"Data Engineering Leader","227630.0","Henry Schein One","docker"
202624,"Rust Data Engineer","225000.0","Understanding Recruitment","rust"
1375618,"Director, Data Engineering (Remote)","221500.0","Brightcove","python"
1375618,"Director, Data Engineering (Remote)","221500.0","Brightcove","nosql"
1375618,"Director, Data Engineering (Remote)","221500.0","Brightcove","scala"
1375618,"Director, Data Engineering (Remote)","221500.0","Brightcove","java"
1375618,"Director, Data Engineering (Remote)","221500.0","Brightcove","snowflake"
1375618,"Director, Data Engineering (Remote)","221500.0","Brightcove","spark"
1375618,"Director, Data Engineering (Remote)","221500.0","Brightcove","kafka"
1375618,"Director, Data Engineering (Remote)","221500.0","Brightcove","kubernetes"
67320,"Staff Data Engineer","220000.0","Harnham","sql"
67320,"Staff Data Engineer","220000.0","Harnham","python"
67320,"Staff Data Engineer","220000.0","Harnham","snowflake"
67320,"Staff Data Engineer","220000.0","Harnham","kafka"
67320,"Staff Data Engineer","220000.0","Harnham","kubernetes"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","sql"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","python"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","nosql"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","java"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","r"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","bash"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","dynamodb"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","azure"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","aws"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","snowflake"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","gcp"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","spark"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","pandas"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","pyspark"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","airflow"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","kafka"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","express"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","git"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","kubernetes"
503833,"Principal AI Data Engineer (Remote)","220000.0","Grindr","docker"
448016,"Principal Data Engineer","215000.0","Storm3","c"
448016,"Principal Data Engineer","215000.0","Storm3","postgresql"
448016,"Principal Data Engineer","215000.0","Storm3","elasticsearch"
448016,"Principal Data Engineer","215000.0","Storm3","databricks"
448016,"Principal Data Engineer","215000.0","Storm3","aws"
448016,"Principal Data Engineer","215000.0","Storm3","snowflake"
448016,"Principal Data Engineer","215000.0","Storm3","spark"
448016,"Principal Data Engineer","215000.0","Storm3","airflow"
536902,"Senior / Staff, Data Engineer","215000.0","Shiftsmart","sql"
536902,"Senior / Staff, Data Engineer","215000.0","Shiftsmart","python"
536902,"Senior / Staff, Data Engineer","215000.0","Shiftsmart","nosql"
536902,"Senior / Staff, Data Engineer","215000.0","Shiftsmart","mongodb"
536902,"Senior / Staff, Data Engineer","215000.0","Shiftsmart","mongodb"
536902,"Senior / Staff, Data Engineer","215000.0","Shiftsmart","spark"
536902,"Senior / Staff, Data Engineer","215000.0","Shiftsmart","airflow"
536902,"Senior / Staff, Data Engineer","215000.0","Shiftsmart","kafka"
373301,"Data Engineer","214000.0","Booz Allen","sql"
373301,"Data Engineer","214000.0","Booz Allen","python"
373301,"Data Engineer","214000.0","Booz Allen","scala"
373301,"Data Engineer","214000.0","Booz Allen","java"
373301,"Data Engineer","214000.0","Booz Allen","mysql"
373301,"Data Engineer","214000.0","Booz Allen","azure"
373301,"Data Engineer","214000.0","Booz Allen","aws"
373301,"Data Engineer","214000.0","Booz Allen","redshift"
373301,"Data Engineer","214000.0","Booz Allen","kafka"
5394,"Staff Data Engineer","211733.0","Swing Education","sql"
5394,"Staff Data Engineer","211733.0","Swing Education","python"
5394,"Staff Data Engineer","211733.0","Swing Education","java"
5394,"Staff Data Engineer","211733.0","Swing Education","javascript"
5394,"Staff Data Engineer","211733.0","Swing Education","clojure"
5394,"Staff Data Engineer","211733.0","Swing Education","aws"
5394,"Staff Data Engineer","211733.0","Swing Education","gcp"
5394,"Staff Data Engineer","211733.0","Swing Education","looker"
457199,"Staff Data Engineer - #16933 - Remote","210000.0","Fanatics, Inc.","sql"
457199,"Staff Data Engineer - #16933 - Remote","210000.0","Fanatics, Inc.","shell"
457199,"Staff Data Engineer - #16933 - Remote","210000.0","Fanatics, Inc.","t-sql"
457199,"Staff Data Engineer - #16933 - Remote","210000.0","Fanatics, Inc.","sql server"
457199,"Staff Data Engineer - #16933 - Remote","210000.0","Fanatics, Inc.","oracle"
457199,"Staff Data Engineer - #16933 - Remote","210000.0","Fanatics, Inc.","snowflake"
2812,"Staff Data Engineer","210000.0","Harnham","sql"
2812,"Staff Data Engineer","210000.0","Harnham","python"
2812,"Staff Data Engineer","210000.0","Harnham","snowflake"
2812,"Staff Data Engineer","210000.0","Harnham","kafka"
2812,"Staff Data Engineer","210000.0","Harnham","kubernetes"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","sql"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","python"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","nosql"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","scala"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","java"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","dynamodb"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","aws"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","redshift"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","snowflake"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","spark"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","airflow"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","hadoop"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","kafka"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","excel"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","github"
171334,"North America Principal Data Engineer (Remote Option*)","208000.0","Nike","confluence"
98048,"Data Engineer, Analytics","207230.21875","Meta","sql"

]

